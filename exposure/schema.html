<!DOCTYPE html><html lang="en"><head><title>exposure/schema</title></head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0"><meta name="groc-relative-root" content="../"><meta name="groc-document-path" content="exposure/schema"><meta name="groc-project-path" content="library/exposure/schema.coffee"><meta name="groc-github-url" content="https://github.com/ts33kr/granite"><link rel="stylesheet" type="text/css" media="all" href="../assets/style.css"><script type="text/javascript" src="../assets/behavior.js"></script><body><div id="meta"><div class="file-path"><a href="https://github.com/ts33kr/granite/blob/master/library/exposure/schema.coffee">library/exposure/schema.coffee</a></div></div><div id="document"><div class="segment"><div class="code"><div class="wrapper"><span class="cm">###</span>
<span class="cm">Copyright (c) 2013, Alexander Cherniuk &lt;ts33kr@gmail.com&gt;</span>
<span class="cm">All rights reserved.</span>

<span class="cm">Redistribution and use in source and binary forms, with or without</span>
<span class="cm">modification, are permitted provided that the following conditions are met:</span>

<span class="cm">1. Redistributions of source code must retain the above copyright notice, this</span>
<span class="cm">   list of conditions and the following disclaimer.</span>
<span class="cm">2. Redistributions in binary form must reproduce the above copyright notice,</span>
<span class="cm">   this list of conditions and the following disclaimer in the documentation</span>
<span class="cm">   and/or other materials provided with the distribution.</span>

<span class="cm">THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; AND</span>
<span class="cm">ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED</span>
<span class="cm">WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE</span>
<span class="cm">DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR</span>
<span class="cm">ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES</span>
<span class="cm">(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;</span>
<span class="cm">LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND</span>
<span class="cm">ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT</span>
<span class="cm">(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS</span>
<span class="cm">SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<span class="cm">###</span>

<span class="nv">_ = </span><span class="nx">require</span> <span class="s">&quot;lodash&quot;</span>
<span class="nv">asciify = </span><span class="nx">require</span> <span class="s">&quot;asciify&quot;</span>
<span class="nv">connect = </span><span class="nx">require</span> <span class="s">&quot;connect&quot;</span>
<span class="nv">logger = </span><span class="nx">require</span> <span class="s">&quot;winston&quot;</span>
<span class="nv">events = </span><span class="nx">require</span> <span class="s">&quot;eventemitter2&quot;</span>
<span class="nv">colors = </span><span class="nx">require</span> <span class="s">&quot;colors&quot;</span>
<span class="nv">assert = </span><span class="nx">require</span> <span class="s">&quot;assert&quot;</span>
<span class="nv">nconf = </span><span class="nx">require</span> <span class="s">&quot;nconf&quot;</span>
<span class="nv">https = </span><span class="nx">require</span> <span class="s">&quot;https&quot;</span>
<span class="nv">http = </span><span class="nx">require</span> <span class="s">&quot;http&quot;</span>
<span class="nv">util = </span><span class="nx">require</span> <span class="s">&quot;util&quot;</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Create a new JSON schema document that adheres to the standard
of JSON Schema Draft v4 by running the supplied builder that uses
the provides DSL methods to build up the schema. This function
returns a ready to use schema represented as an object. Please see
http://json-schema.org/latest/json-schema-core.html for reference.</p></div></div><div class="code"><div class="wrapper"><span class="nv">module.exports.schema = schema = </span><span class="nf">(id, title, pointer) -&gt;</span>
    <span class="nv">context = </span><span class="nb">Object</span><span class="p">.</span><span class="nx">create</span> <span class="k">new</span> <span class="nb">Object</span>
    <span class="nv">context = </span><span class="nx">_</span><span class="p">.</span><span class="nx">extend</span> <span class="nx">context</span><span class="p">,</span> <span class="nx">module</span><span class="p">.</span><span class="nx">exports</span>
    <span class="nv">noId = </span><span class="s">&quot;no schema identification tag is given&quot;</span>
    <span class="nv">noTitle = </span><span class="s">&quot;no schema human readable name is given&quot;</span>
    <span class="nv">context.$schema = </span><span class="s">&quot;http://json-schema.org/draft-04/schema</span><span class="err">#</span><span class="s">&quot;</span>
    <span class="nv">rematerialize = </span><span class="nf">(obj) -&gt;</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span> <span class="nx">obj</span>
    <span class="nx">assert</span> <span class="nx">_</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">pointer</span><span class="p">),</span> <span class="s">&quot;got no valid schema pointer&quot;</span>
    <span class="nx">assert</span> <span class="nx">_</span><span class="p">.</span><span class="nx">isString</span><span class="p">(</span><span class="nv">context.title = </span><span class="nx">title</span><span class="p">),</span> <span class="nx">noTitle</span>
    <span class="nx">assert</span> <span class="nx">_</span><span class="p">.</span><span class="nx">isString</span><span class="p">(</span><span class="nv">context.id = </span><span class="nx">id</span><span class="p">),</span> <span class="nx">noId</span>
    <span class="k">return</span> <span class="nx">rematerialize</span> <span class="nx">pointer</span><span class="p">.</span><span class="nx">apply</span> <span class="nx">context</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Create a reference to a JSON schema object within the context. The
object is described in terms of key/value pairs, as they found by
invoking the supplied pointer that should return plain object. This
object should expose members that will be treated as properties. A
member value should be a valid pointer to an arbitrary data type.</p></div></div><div class="code"><div class="wrapper"><span class="nv">module.exports.object = object = </span><span class="p">(</span><span class="nx">description</span><span class="p">,</span> <span class="nx">pointer</span><span class="o">=</span><span class="p">(</span><span class="nf">-&gt;</span><span class="p">))</span> <span class="nf">-&gt;</span>
    <span class="nv">noPointer = </span><span class="s">&quot;got no pointer to the object members&quot;</span>
    <span class="nv">noDescription = </span><span class="s">&quot;no description has been given&quot;</span>
    <span class="nx">assert</span> <span class="nx">_</span><span class="p">.</span><span class="nx">isString</span><span class="p">(</span><span class="nx">description</span><span class="p">),</span> <span class="nx">noDescription</span>
    <span class="nx">assert</span> <span class="nx">_</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">pointer</span><span class="p">),</span> <span class="nx">noPointer</span>
    <span class="vi">@description = </span><span class="nx">description</span><span class="p">.</span><span class="nx">toString</span><span class="p">()</span>
    <span class="nv">compiled = </span><span class="nx">pointer</span><span class="p">.</span><span class="nx">apply</span> <span class="k">this</span><span class="p">,</span> <span class="nx">arguments</span>
    <span class="nv">props = </span><span class="vi">@properties = </span><span class="nb">Object</span><span class="p">.</span><span class="nx">create</span> <span class="k">this</span>
    <span class="nv">regex = </span><span class="vi">@patternProperties = </span><span class="nb">Object</span><span class="p">.</span><span class="nx">create</span> <span class="k">this</span>
    <span class="nv">isp = </span><span class="nf">(k, p) -&gt;</span> <span class="nx">_</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">p</span><span class="p">)</span> <span class="o">and</span> <span class="o">not</span> <span class="nx">p</span><span class="p">.</span><span class="nx">pattern</span><span class="o">?</span>
    <span class="nv">isr = </span><span class="nf">(k, p) -&gt;</span> <span class="nx">_</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">p</span><span class="p">)</span> <span class="o">and</span> <span class="nx">p</span><span class="p">.</span><span class="nx">pattern</span> <span class="o">is</span> <span class="kc">yes</span>
    <span class="nv">f = </span><span class="nf">(k, p) =&gt;</span> <span class="nx">p</span><span class="p">.</span><span class="nx">apply</span> <span class="nv">n = </span><span class="nb">Object</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">@</span><span class="p">),</span> <span class="nx">arguments</span><span class="p">;</span> <span class="nx">n</span>
    <span class="nx">props</span><span class="p">[</span><span class="nx">k</span><span class="p">]</span> <span class="o">=</span> <span class="nx">f</span> <span class="nx">k</span><span class="p">,</span> <span class="nx">p</span> <span class="k">for</span> <span class="nx">k</span><span class="p">,</span> <span class="nx">p</span> <span class="k">of</span> <span class="nx">compiled</span> <span class="k">when</span> <span class="nx">isp</span><span class="p">(</span><span class="nx">k</span><span class="p">,</span> <span class="nx">p</span><span class="p">)</span>
    <span class="nx">regex</span><span class="p">[</span><span class="nx">k</span><span class="p">]</span> <span class="o">=</span> <span class="nx">f</span> <span class="nx">k</span><span class="p">,</span> <span class="nx">p</span> <span class="k">for</span> <span class="nx">k</span><span class="p">,</span> <span class="nx">p</span> <span class="k">of</span> <span class="nx">compiled</span> <span class="k">when</span> <span class="nx">isr</span><span class="p">(</span><span class="nx">k</span><span class="p">,</span> <span class="nx">p</span><span class="p">)</span>
    <span class="vi">@type = </span><span class="s">&quot;object&quot;</span><span class="p">;</span> <span class="k">return</span> <span class="k">this</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Create a reference to a JSON schema array that contains objects in
it. This is pretty much the same as declaring an array with object
pointer passed to it, so this is just a convenient shorthand to aid
in writing less code. You should normally supply the pointer that
points to object members. Please refer to <code>object</code> implementation
for more information on the pointer and object creation routine.</p></div></div><div class="code"><div class="wrapper"><span class="nv">module.exports.objects = objects = </span><span class="p">(</span><span class="nx">description</span><span class="p">,</span> <span class="nx">pointer</span><span class="o">=</span><span class="p">(</span><span class="nf">-&gt;</span><span class="p">))</span> <span class="nf">-&gt;</span>
    <span class="nv">noPointer = </span><span class="s">&quot;got no pointer to array elements&quot;</span>
    <span class="nv">noDescription = </span><span class="s">&quot;no description has been given&quot;</span>
    <span class="nv">addendum = </span><span class="s">&quot;an array of items: </span><span class="si">#{</span><span class="nx">description</span><span class="si">}</span><span class="s">&quot;</span>
    <span class="nx">assert</span> <span class="nx">_</span><span class="p">.</span><span class="nx">isString</span><span class="p">(</span><span class="nx">description</span><span class="p">),</span> <span class="nx">noDescription</span>
    <span class="nx">assert</span> <span class="nx">_</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">pointer</span><span class="p">),</span> <span class="nx">noPointer</span>
    <span class="nv">reference = </span><span class="nf">-&gt;</span> <span class="nx">@object</span> <span class="nx">description</span><span class="p">,</span> <span class="nx">pointer</span>
    <span class="nx">@array</span> <span class="nx">addendum</span><span class="p">,</span> <span class="nx">reference</span><span class="p">;</span> <span class="k">return</span> <span class="k">this</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Create a reference to a JSON schema array within the context. The
array should be described it terms of items that it holds. These
items will be retrieved by invoking the supplied pointer function.
The array can point to primitive types as well as complex types.
Please make sure the pointer actually points to some schema type.</p></div></div><div class="code"><div class="wrapper"><span class="nv">module.exports.array = array = </span><span class="nf">(description, pointer) -&gt;</span>
    <span class="nv">noPointer = </span><span class="s">&quot;got no pointer to array elements&quot;</span>
    <span class="nv">noDescription = </span><span class="s">&quot;no description has been given&quot;</span>
    <span class="nx">assert</span> <span class="nx">_</span><span class="p">.</span><span class="nx">isString</span><span class="p">(</span><span class="nx">description</span><span class="p">),</span> <span class="nx">noDescription</span>
    <span class="nx">assert</span> <span class="nx">_</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">pointer</span><span class="p">),</span> <span class="nx">noPointer</span>
    <span class="nv">items = </span><span class="nb">Object</span><span class="p">.</span><span class="nx">create</span> <span class="k">this</span><span class="p">;</span> <span class="vi">@items = </span><span class="nx">items</span>
    <span class="vi">@description = </span><span class="nx">description</span><span class="p">.</span><span class="nx">toString</span><span class="p">()</span>
    <span class="nx">pointer</span><span class="p">.</span><span class="nx">apply</span> <span class="nx">items</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">;</span>
    <span class="vi">@type = </span><span class="s">&quot;array&quot;</span><span class="p">;</span> <span class="k">return</span> <span class="k">this</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Modify the current name/value property as they found in JSON object
to be treated as the pattern property, as specified in the schema
draft v4. This modifier should only be applied within the context of
an object, otherwise it does not make any sense, by the definition.
Please be aware that the modifier is set on the value, not on key!</p></div></div><div class="code"><div class="wrapper"><span class="nv">module.exports.pattern = pattern = </span><span class="nf">(pointer) -&gt;</span>
    <span class="nv">notPointer = </span><span class="s">&quot;incorrect pointer for pattern&quot;</span>
    <span class="nv">notObject = </span><span class="s">&quot;pattern used outside of object&quot;</span>
    <span class="nv">alreadyMarked = </span><span class="s">&quot;pointer is already a pattern&quot;</span>
    <span class="nx">assert</span> <span class="o">not</span> <span class="nx">pointer</span><span class="p">.</span><span class="nx">pattern</span><span class="o">?</span><span class="p">,</span> <span class="nx">alreadyMarked</span>
    <span class="nx">assert</span> <span class="nx">_</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">pointer</span><span class="p">),</span> <span class="nx">notPointer</span>
    <span class="nx">assert</span> <span class="nx">@patternProperties</span><span class="o">?</span><span class="p">,</span> <span class="nx">notObject</span>
    <span class="nv">pointer.pattern = </span><span class="kc">yes</span><span class="p">;</span> <span class="k">return</span> <span class="nx">pointer</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Modify the pointer decorated with this method as a required member.
This modifier may only be used inside of the JSON object as defined
by the JSON schema draft v4. specification. Beware, this method does
modify the context object, although is being applied to the pointer.
This corresponds to the draft v4 as oppositve of the draft v3 spec.</p></div></div><div class="code"><div class="wrapper"><span class="nv">module.exports.must = must = </span><span class="nf">(pointer) -&gt;</span> <span class="nf">(key) -&gt;</span>
    <span class="nv">isObject = </span><span class="nx">@properties</span><span class="o">?</span> <span class="o">or</span> <span class="nx">patternProperties</span><span class="o">?</span>
    <span class="nx">assert</span> <span class="nx">_</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">pointer</span><span class="p">),</span> <span class="s">&quot;incorrect pointer for must&quot;</span>
    <span class="nx">assert</span> <span class="nx">_</span><span class="p">.</span><span class="nx">isString</span><span class="p">(</span><span class="nx">key</span><span class="p">),</span> <span class="s">&quot;invalid name of property: </span><span class="si">#{</span><span class="nx">key</span><span class="si">}</span><span class="s">&quot;</span>
    <span class="nx">assert</span> <span class="nx">isObject</span><span class="p">,</span> <span class="s">&quot;must can only be used on object&quot;</span>
    <span class="nv">required = </span><span class="nx">@required</span> <span class="k">if</span> <span class="nx">_</span><span class="p">.</span><span class="nx">has</span> <span class="k">this</span><span class="p">,</span> <span class="s">&quot;required&quot;</span>
    <span class="vi">@required = </span><span class="p">(</span><span class="nx">required</span> <span class="o">or</span> <span class="p">[]).</span><span class="nx">concat</span> <span class="nx">key</span>
    <span class="k">return</span> <span class="nx">pointer</span><span class="p">.</span><span class="nx">apply</span> <span class="k">this</span><span class="p">,</span> <span class="nx">arguments</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Modify the supplied JSON object reference to mark this object as
strict. This means that if an object contains any other properties
except for the explicitly declared ones, it will be invalid marked
invalid, as specified according to JSON schema draft v4 standard.
This applicable to a single object as well as an array of objects.</p></div></div><div class="code"><div class="wrapper"><span class="nv">module.exports.strict = strict = </span><span class="nf">(reference) -&gt;</span>
    <span class="nv">invalidSubject = </span><span class="s">&quot;subject is none of an object&quot;</span>
    <span class="nv">subject = </span><span class="nx">reference</span> <span class="k">if</span> <span class="nx">reference</span><span class="p">.</span><span class="nx">type</span> <span class="o">is</span> <span class="s">&quot;object&quot;</span>
    <span class="nv">subject = </span><span class="nx">reference</span><span class="p">.</span><span class="nx">items</span> <span class="k">if</span> <span class="nx">reference</span><span class="p">.</span><span class="nx">type</span> <span class="o">is</span> <span class="s">&quot;array&quot;</span>
    <span class="nx">assert</span> <span class="nx">reference</span><span class="p">.</span><span class="nx">type</span> <span class="o">is</span> <span class="s">&quot;object&quot;</span><span class="p">,</span> <span class="nx">invalidSubject</span>
    <span class="nx">assert</span> <span class="nx">_</span><span class="p">.</span><span class="nx">isObject</span> <span class="nx">reference</span><span class="p">.</span><span class="nx">properties</span>
    <span class="nx">assert</span> <span class="nx">_</span><span class="p">.</span><span class="nx">isObject</span> <span class="nx">reference</span><span class="p">.</span><span class="nx">patternProperties</span>
    <span class="nv">reference.additionalProperties = </span><span class="kc">no</span><span class="p">;</span> <span class="nx">reference</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Create a reference to the JSON enumeration. An enumeration defines
what values are valid for this data type. Everything else beyond
those values are considered invalid. This version may take array
of values as array object, which is useful for creating enums in
a programatic fashion as well as collect the trailing arguments.
Makes sure all values are plain strings anyway. Errors out if not.</p></div></div><div class="code"><div class="wrapper"><span class="nv">module.exports.choose = choose = </span><span class="nf">(description, values...) -&gt;</span>
    <span class="nv">noValues = </span><span class="s">&quot;all values must be primitive strings&quot;</span>
    <span class="nv">noDescription = </span><span class="s">&quot;no description has been given&quot;</span>
    <span class="nv">values = </span><span class="nx">head</span> <span class="k">if</span> <span class="nx">_</span><span class="p">.</span><span class="nx">isArray</span> <span class="nv">head = </span><span class="nx">_</span><span class="p">.</span><span class="nx">head</span> <span class="nx">values</span>
    <span class="nx">assert</span> <span class="nx">_</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">values</span><span class="p">),</span> <span class="s">&quot;values are not array&quot;</span>
    <span class="nx">assert</span> <span class="nx">_</span><span class="p">.</span><span class="nx">isString</span><span class="p">(</span><span class="nx">description</span><span class="p">),</span> <span class="nx">noDescription</span>
    <span class="nx">assert</span> <span class="nx">_</span><span class="p">.</span><span class="nx">all</span><span class="p">(</span><span class="nx">values</span><span class="p">,</span> <span class="nx">_</span><span class="p">.</span><span class="nx">isString</span><span class="p">),</span> <span class="nx">noValues</span>
    <span class="vi">@description = </span><span class="nx">description</span><span class="p">.</span><span class="nx">toString</span><span class="p">()</span>
    <span class="vi">@enum = </span><span class="nx">values</span><span class="p">;</span> <span class="k">return</span> <span class="k">this</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Create a reference to a JSON schema array with references to the
JSON schema numbers inside of the array. This is a variation of
the plain <code>number</code> method, with the exception that it makes arrays
of numbers instead of numbers. This is complementatory DSL part.
Please refer to the original <code>number</code> implementation for the info.</p></div></div><div class="code"><div class="wrapper"><span class="nv">module.exports.numbers = numbers = </span><span class="nf">(description, props) -&gt;</span>
    <span class="nv">noProps = </span><span class="s">&quot;no valid properties object supplied&quot;</span>
    <span class="nv">noDescription = </span><span class="s">&quot;no description has been given&quot;</span>
    <span class="nv">props = </span><span class="nx">props</span><span class="p">.</span><span class="nx">apply</span> <span class="k">this</span> <span class="k">if</span> <span class="nx">_</span><span class="p">.</span><span class="nx">isFunction</span> <span class="nx">props</span>
    <span class="nx">assert</span> <span class="nx">_</span><span class="p">.</span><span class="nx">isString</span><span class="p">(</span><span class="nx">description</span><span class="p">),</span> <span class="nx">noDescription</span>
    <span class="nx">props</span> <span class="o">?=</span> <span class="p">{};</span> <span class="nx">assert</span> <span class="nx">_</span><span class="p">.</span><span class="nx">isObject</span><span class="p">(</span><span class="nx">props</span><span class="p">),</span> <span class="nx">noProps</span>
    <span class="nx">@array</span> <span class="s">&quot;array of number items: </span><span class="si">#{</span><span class="nx">description</span><span class="si">}</span><span class="s">&quot;</span><span class="p">,</span> <span class="nf">-&gt;</span>
        <span class="k">return</span> <span class="nx">@number</span> <span class="nx">description</span><span class="p">,</span> <span class="nx">props</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Create a reference to a JSON schema array with references to the
JSON schema strings inside of the array. This is a variation of
the plain <code>string</code> method, with the exception that it makes arrays
of strings instead of strings. This is complementatory DSL part.
Please refer to the original <code>string</code> implementation for the info.</p></div></div><div class="code"><div class="wrapper"><span class="nv">module.exports.strings = strings = </span><span class="nf">(description, props) -&gt;</span>
    <span class="nv">noProps = </span><span class="s">&quot;no valid properties object supplied&quot;</span>
    <span class="nv">noDescription = </span><span class="s">&quot;no description has been given&quot;</span>
    <span class="nv">props = </span><span class="nx">props</span><span class="p">.</span><span class="nx">apply</span> <span class="k">this</span> <span class="k">if</span> <span class="nx">_</span><span class="p">.</span><span class="nx">isFunction</span> <span class="nx">props</span>
    <span class="nx">assert</span> <span class="nx">_</span><span class="p">.</span><span class="nx">isString</span><span class="p">(</span><span class="nx">description</span><span class="p">),</span> <span class="nx">noDescription</span>
    <span class="nx">props</span> <span class="o">?=</span> <span class="p">{};</span> <span class="nx">assert</span> <span class="nx">_</span><span class="p">.</span><span class="nx">isObject</span><span class="p">(</span><span class="nx">props</span><span class="p">),</span> <span class="nx">noProps</span>
    <span class="nx">@array</span> <span class="s">&quot;array of string items: </span><span class="si">#{</span><span class="nx">description</span><span class="si">}</span><span class="s">&quot;</span><span class="p">,</span> <span class="nf">-&gt;</span>
        <span class="k">return</span> <span class="nx">@string</span> <span class="nx">description</span><span class="p">,</span> <span class="nx">props</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Create a reference to a JSON schema number within the context. The
number can optionally be followed by an object that contains some
validation restrictions, as they are found in the JSON schema v4 or
some other properties. This object can also be expressed as function
that will be immediatelly invoked and should return a plain object.</p></div></div><div class="code"><div class="wrapper"><span class="nv">module.exports.number = number = </span><span class="nf">(description, props) -&gt;</span>
    <span class="nv">noProps = </span><span class="s">&quot;no valid properties object supplied&quot;</span>
    <span class="nv">noDescription = </span><span class="s">&quot;no description has been given&quot;</span>
    <span class="nv">props = </span><span class="nx">props</span><span class="p">.</span><span class="nx">apply</span> <span class="k">this</span> <span class="k">if</span> <span class="nx">_</span><span class="p">.</span><span class="nx">isFunction</span> <span class="nx">props</span>
    <span class="nx">assert</span> <span class="nx">_</span><span class="p">.</span><span class="nx">isString</span><span class="p">(</span><span class="nx">description</span><span class="p">),</span> <span class="nx">noDescription</span>
    <span class="nx">props</span> <span class="o">?=</span> <span class="p">{};</span> <span class="nx">assert</span> <span class="nx">_</span><span class="p">.</span><span class="nx">isObject</span><span class="p">(</span><span class="nx">props</span><span class="p">),</span> <span class="nx">noProps</span>
    <span class="vi">@description = </span><span class="nx">description</span><span class="p">.</span><span class="nx">toString</span><span class="p">()</span>
    <span class="vi">@type = </span><span class="s">&quot;number&quot;</span><span class="p">;</span> <span class="nx">_</span><span class="p">.</span><span class="nx">extend</span> <span class="k">this</span><span class="p">,</span> <span class="nx">props</span><span class="p">;</span> <span class="nx">@</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Create a reference to a JSON schema string within the context. The
string can optionally be followed by an object that contains some
validation restrictions, as they are found in the JSON schema v4 or
some other properties. This object can also be expressed as function
that will be immediatelly invoked and should return a plain object.</p></div></div><div class="code"><div class="wrapper"><span class="nv">module.exports.string = string = </span><span class="nf">(description, props) -&gt;</span>
    <span class="nv">noProps = </span><span class="s">&quot;no valid properties object supplied&quot;</span>
    <span class="nv">noDescription = </span><span class="s">&quot;no description has been given&quot;</span>
    <span class="nv">props = </span><span class="nx">props</span><span class="p">.</span><span class="nx">apply</span> <span class="k">this</span> <span class="k">if</span> <span class="nx">_</span><span class="p">.</span><span class="nx">isFunction</span> <span class="nx">props</span>
    <span class="nx">assert</span> <span class="nx">_</span><span class="p">.</span><span class="nx">isString</span><span class="p">(</span><span class="nx">description</span><span class="p">),</span> <span class="nx">noDescription</span>
    <span class="nx">props</span> <span class="o">?=</span> <span class="p">{};</span> <span class="nx">assert</span> <span class="nx">_</span><span class="p">.</span><span class="nx">isObject</span><span class="p">(</span><span class="nx">props</span><span class="p">),</span> <span class="nx">noProps</span>
    <span class="vi">@description = </span><span class="nx">description</span><span class="p">.</span><span class="nx">toString</span><span class="p">()</span>
    <span class="vi">@type = </span><span class="s">&quot;string&quot;</span><span class="p">;</span> <span class="nx">_</span><span class="p">.</span><span class="nx">extend</span> <span class="k">this</span><span class="p">,</span> <span class="nx">props</span><span class="p">;</span> <span class="nx">@</span></div></div></div></div></body></html>